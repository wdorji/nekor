"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.processOptions = void 0;
const fs_1 = __importDefault(require("fs"));
const path_1 = __importDefault(require("path"));
function processOptions(rawRCOptions) {
    // reversing the config so the first one is the closest.
    const dirs = rawRCOptions.configs ? rawRCOptions.configs.map(path_1.default.dirname) : [];
    const onStart = processRCFileEntry(rawRCOptions.onStart, dirs);
    const onSuitePass = processRCFileEntry(rawRCOptions.onSuitePass, dirs);
    const onSuiteFailure = processRCFileEntry(rawRCOptions.onSuiteFailure, dirs);
    const onStartThreshold = rawRCOptions.onStartThreshold !== undefined ? parseInt(rawRCOptions.onStartThreshold, 10) : 10;
    return {
        onStartThreshold,
        onStart,
        onSuitePass,
        onSuiteFailure
    };
}
exports.processOptions = processOptions;
function processRCFileEntry(files, dirs) {
    if (!files)
        return [];
    const entries = typeof files === 'string' ? [files] : files;
    const validFiles = [];
    entries.forEach(e => {
        if (path_1.default.isAbsolute(e)) {
            validFiles.push(e);
        }
        else {
            const file = dirs.map(dir => path_1.default.resolve(dir, e)).find(p => fs_1.default.existsSync(p));
            if (file) {
                validFiles.push(file);
            }
        }
    });
    return validFiles;
}
//# sourceMappingURL=options.js.map